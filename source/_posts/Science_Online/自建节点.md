---
title: 自建节点（详细）
date: 2023-07-29 15:49:37
author: Taniz Hugo
language: zh-CN
abbrlink: so3
top: false
is_draft: false
summary: 跟着不良林大神学习节点搭建，实现科学上网
categories: 
  - 科学上网
tags:
  - v2rayN
  -	vmess
  - torjan
  - vless
  -	x-ui
---

## 搭建过程

### 客户端

[Windows（v2rayN）](https://github.com/2dust/v2rayN/releases/tag/6.23)

[Android（v2rayNG）](https://github.com/2dust/v2rayNG/releases/tag/1.8.5)

[IOS（shadowrocket）](https://apps.apple.com/app/shadowrocket/id932747118)

[IOS（Quantumult X）](https://apps.apple.com/us/app/quantumult-x/id1443988620)

### 服务端

* 一台国外VPS（运营商：Vultr）

* 自己的域名

* 工具：x-ui

  

### 服务器地区选择

* 移动用户：日本、新加坡
* 联调用户：新加坡、洛杉矶、硅谷、西雅图
* 电信用户：洛杉矶、硅谷、雅图（不推荐日本和新加坡）



#### 安装Docker

```shell
curl -fsSL https://get.docker.com | sh
```



#### x-ui 安装命令

```shell
# 直接安装
bash <(curl -Ls https://raw.githubusercontent.com/FranzKafkaYu/x-ui/956bf85bbac978d56c0e319c5fac2d6db7df9564/install.sh)

# Docker安装
mkdir -p /etc/cert/
mkdir -p /etc/x-ui/db/ && cd /etc/x-ui/db/

docker run -itd --network=host \
    -v /etc/x-ui/db/:/etc/x-ui/ \
    -v /etc/cert/:/etc/cert/ \
    --name x-ui --restart=unless-stopped \
    enwaiax/x-ui:alpha-zh
```



#### 替换x-ui.db文件

```shell
root@vultr:~# ls /etc/x-ui/db/
x-ui.db
```



#### 添加DNS记录

https://dash.cloudflare.com/

添加A类型记录，不需要代理
![image-20230814133749108](https://s2.loli.net/2023/08/20/FVfln4DrjaoyBgz.png)



#### 申请域名

```shell
# 创建cert文件夹存放证书
mkdir -p /etc/cer

#安装证书工具：
curl https://get.acme.sh | sh; apt install socat -y || yum install socat -y; ~/.acme.sh/acme.sh --set-default-ca --server letsencrypt

#添加软链接：
ln -s  /root/.acme.sh/acme.sh /usr/local/bin/acme.sh

#切换CA机构： 
acme.sh --set-default-ca --server letsencrypt

# 开放80端口提供访问
ufw allow 80

#申请证书方式1： 
acme.sh  --issue -d 替换为你的域名 --standalone -k ec-256
#申请证书方式2： 
acme.sh --register-account -m "${RANDOM}@chacuo.net" --server buypass --force --insecure && ~/.acme.sh/acme.sh  --issue -d 你的域名 --standalone -k ec-256 --force --insecure --server buypass
#申请证书方式3：
acme.sh --register-account -m "${RANDOM}@chacuo.net" --server zerossl --force --insecure && ~/.acme.sh/acme.sh  --issue -d 你的域名 --standalone -k ec-256 --force --insecure --server zerossl

#安装证书：
acme.sh --install-cert -d 你的域名 --ecc --key-file /etc/cert/server.key --fullchain-file /etc/cert/server.crt
```



#### 添加入栈规则

* vmess+ws

![vmess+ws](https://s2.loli.net/2023/08/20/s4tM81kXgW3uiwC.jpg)

* vless+tls

![vless+tls](https://s2.loli.net/2023/08/21/RwcY2O3V41FnzUW.jpg)

* trojan

![trojan](https://s2.loli.net/2023/08/20/jaXf3UxIy1coSh9.jpg)



#### 添加代理服务器

x-ui入站规则 -> 操作 -> 二维码

客户端打开v2rayN扫码添加节点即可使用
